apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: vote
  name: vote
spec:
  replicas: 1
  selector:
    matchLabels:
      app: vote
  template:
    metadata:
      labels:
        app: vote
    spec:
      containers:
      - name: vote
        image: dockersamples/examplevotingapp_vote
        ports:
        - containerPort: 80
          name: http

        # Add health probes
        readinessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 5   # wait before first probe
          periodSeconds: 10        # how often to probe
          timeoutSeconds: 2
          failureThreshold: 3      # pod marked Unready after 3 failures
          successThreshold: 1      # 1 success to mark Ready

        livenessProbe:
          httpGet:
            path: /
            port: 80
          initialDelaySeconds: 15  # wait before first probe
          periodSeconds: 20        # how often to probe
          timeoutSeconds: 2
          failureThreshold: 3      # container restarted after 3 failures
